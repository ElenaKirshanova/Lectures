% !TeX program = xelatex
% !BIB TS-program = biber

\documentclass{beamer}

\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}

%---tikz----
\usepackage{tikz}
\usetikzlibrary{arrows, chains, matrix, positioning, scopes, patterns, shapes}
\usepackage{pgfplots, subfigure}
\usepackage{extarrows}

\usepackage[backend=biber,firstinits=true,hyperref=true,style=numeric-comp]{biblatex}

\usepackage{../beamerthemeec2020}
{\footnotesize\bibliography{../biblio}}

\title{Эллиптические кривые}
\subtitle{Лекция 2. Групповой закон}
\author{Семён Новосёлов}
\institute{БФУ им. И. Канта}
\date{2022}

\begin{document}
	
	\frame{\titlepage}
	
	\begin{frame}{Групповой закон}%{Аффинные координаты}
		\begin{center}
			$E/K: y^2 = x^3 + Ax + B$
		\end{center}
		\begin{columns}
			\begin{column}{0.5\textwidth}
				\begin{equation*}
					\begin{split}
						P_1 &= (x_1, y_1) \in E \\
						P_2 &= (x_2, y_2) \in E \\
						P_3 &= P_1 + P_2 = \left(x_3, y_3\right)
					\end{split}
				\end{equation*}
				\structure{Случай $x_1 \ne x_2$:}
				\begin{equation*}
					\begin{split}
						x_3 &= m^2 - x_1 - x_2 \\
						y_3 &= m\left( x_1 - x_3 \right) - y_1 \\
						m &= \frac{y_2 - y_1}{x_2 - x_1}
					\end{split}
				\end{equation*}
				\begin{center}
					\begin{tcolorbox}[enhanced,hbox,colback=box-blue-color!15,colframe=box-blue-color,title=Сложность,center title]
						\begin{varwidth}{\textwidth}
							\begin{center}
								I + $3$M в $K$
							\end{center}
						\end{varwidth}
					\end{tcolorbox}	
				\end{center}
				
			\end{column}
			\begin{column}{0.5\textwidth}
				\begin{figure}[h!]
					\centering
					\begin{tikzpicture}[scale=0.85]
						\begin{axis}[
							xmin=-4,
							xmax=5,
							xtick=\empty,
							ytick=\empty,
							ymin=-5,
							ymax=5,
							xlabel={$x$},
							ylabel={$y$},
							scale only axis,
							axis lines=middle,
							style={thick},
							domain=-2.279018:3,      
							samples=201,
							smooth,   
							clip=false,
							axis equal image=true,
							]
							\addplot[color=plot-blue-color] {sqrt(x^3-3*x+5)} node[right] {$E$};
							\addplot[color=plot-blue-color] {-sqrt(x^3-3*x+5)};
							\addplot[color=plot-red-color] coordinates {(-3, -0.0890722)(3, 3.06557)} node[right] {$\ell$};
							\addplot[color=plot-green-color] coordinates {(1.9, 3.5)(1.9, -3.5)};
							\draw [fill=black] (axis cs: 0.65, 1.83) circle (2pt);
							\draw[color=black] (axis cs: 1.2, 1.3) node [left]{$P_2$};
							\draw [fill=black] (axis cs: -2.26, 0.3) circle (2pt);
							\draw[color=black] (axis cs: -2.3, 0.3) node [left]{$P_1$};
							\draw [fill=black] (axis cs: 1.9, 2.5) circle (2pt);
							\draw[color=black] (axis cs: 1.9, 2.8) node [left]{$P_3'$};
							\draw [fill=black] (axis cs: 1.9, -2.5) circle (2pt);
							\draw[color=black] (axis cs: 1.9, -2.8) node [left]{$P_3$};
						\end{axis}
					\end{tikzpicture}
				\end{figure}
			\end{column}
		\end{columns}
	\end{frame}
	
	
	\begin{frame}{Групповой закон - 2}%{Аффинные координаты}
		\begin{center}
			$E/K: y^2 = x^3 + Ax + B$
		\end{center}
		\begin{columns}
			\begin{column}{0.5\textwidth}
				\begin{equation*}
					\begin{split}
						P_1 &= (x_1, y_1) \in E \\
						P_2 &= (x_2, y_2) \in E \\
						P_3 &= P_1 + P_2 = \left(x_3, y_3\right)
					\end{split}
				\end{equation*}
				\structure{Случай $x_1 = x_2$, $y_1 \neq y_2$ или $P_1 = P_2, y_1 = 0$:}
				\begin{equation*}
					{P_1} + {P_2} = \mathcal{O}
				\end{equation*}            
			\end{column}
			\begin{column}{0.5\textwidth}
				\begin{figure}[h!]
					\centering
					\begin{tikzpicture}[scale=0.85]
						\begin{axis}[
							xmin=-4,
							xmax=5,
							xtick=\empty,
							ytick=\empty,
							ymin=-5,
							ymax=5,
							xlabel={$x$},
							ylabel={$y$},
							scale only axis,
							axis lines=middle,
							style={thick},
							domain=-2.279018:3,      
							samples=201,
							smooth,   
							clip=false,
							axis equal image=true,
							]
							\addplot[color=plot-blue-color] {sqrt(x^3-3*x+5)} node[right] {$E$};
							\addplot[color=plot-blue-color] {-sqrt(x^3-3*x+5)};
							\addplot[color=plot-red-color] coordinates {(-1.0, 3.65)(-1.0, -3.65)};
							\draw [fill=black] (axis cs: -1.0, 2.65) circle (2pt);
							\draw[color=black] (axis cs: -1.0, 3.0) node [left]{$P_1$};
							\draw [fill=black] (axis cs: -1.0, -2.65) circle (2pt);
							\draw[color=black] (axis cs: -1.0, -3.0) node [left]{$P_2$};
						\end{axis}
					\end{tikzpicture}
				\end{figure}
			\end{column}
		\end{columns}
	\end{frame}
	
	\begin{frame}{Групповой закон - 3}%{Аффинные координаты}
		\begin{center}
			$E/K: y^2 = x^3 + Ax + B$
		\end{center}
		\begin{columns}
			\begin{column}{0.5\textwidth}
				\begin{equation*}
					\begin{split}
						P_1 &= (x_1, y_1) \in E \\
						P_2 &= (x_2, y_2) \in E \\
						P_3 &= P_1 + P_2 = \left(x_3, y_3\right)
					\end{split}
				\end{equation*}
				\structure{Случай ${P_1} = {P_2}$, ${y_1} \ne 0$:}
				\begin{equation*}
					\begin{split}
						x_3 &= m^2 - 2 x_1 \\
						y_3 &= m\left( x_1 - x_3 \right) - y_1\\
						m   &= \frac{3x_1^2 + A}{2 y_1} \\ 
					\end{split}
				\end{equation*}
				\begin{center}
					\begin{tcolorbox}[enhanced,hbox,colback=box-blue-color!15,colframe=box-blue-color,title=Сложность,center title]
						\begin{varwidth}{\textwidth}
							\begin{center}
								I + $4$M в $K$
							\end{center}
						\end{varwidth}
					\end{tcolorbox}	
				\end{center}
				
			\end{column}
			\begin{column}{0.5\textwidth}
				\begin{figure}[h!]
					\centering
					\begin{tikzpicture}[scale=0.85]
						\begin{axis}[
							xmin=-4,
							xmax=5,
							xtick=\empty,
							ytick=\empty,
							ymin=-5,
							ymax=5,
							xlabel={$x$},
							ylabel={$y$},
							scale only axis,
							axis lines=middle,
							style={thick},
							domain=-2.279018:3,      
							samples=201,
							smooth,   
							clip=false,
							axis equal image=true,
							]
							\addplot[color=plot-blue-color] {sqrt(x^3-3*x+5)} node[right] {$E$};
							\addplot[color=plot-blue-color] {-sqrt(x^3-3*x+5)};
							\addplot[color=plot-red-color] {2.65 + ((-3.0) + 3*(-1.2)^2)/(2*2.65) * (x - (-1.2))}  node[right] {$\ell$};
							\addplot[color=plot-green-color] coordinates {(2.5, 4.5)(2.5, -4.5)};
							\draw [fill=black] (axis cs: -1.2, 2.65) circle (2pt);
							\draw[color=black] (axis cs: -1.0, 3.0) node [left]{$P_1$};
							\draw [fill=black] (axis cs: 2.5, 3.6) circle (2pt);
							\draw[color=black] (axis cs: 2.5, 3.9) node [left]{$P_3'$};
							\draw [fill=black] (axis cs: 2.5, -3.6) circle (2pt);
							\draw[color=black] (axis cs: 2.5, -3.9) node [left]{$P_3$};
						\end{axis}
					\end{tikzpicture}
				\end{figure}
			\end{column}
		\end{columns}
	\end{frame}
	
	\begin{frame}{Групповой закон - 4}%{Аффинные координаты}
		\begin{tcolorbox}[colframe=title-and-section-color!120, colback=title-and-section-color!5, title=Теорема, center title]
			%Операция сложения на $E$ обладает свойствами:
			\begin{enumerate}
				\item $P_1 + P_2 = P_2 + P_1$ \hfill \textit{(коммутативность)}
				
				\item $P + \mathcal{O} = P$ $\forall P \in E$ \hfill \textit{($\exists$ нейтральный элемент)}
				
				\item $\forall P \in E$ $\exists P' \in E: P + P' = \mathcal{O}$ \hfill \textit{($\exists$ обратный элемент)}
				
				\item $\left( P_1 + P_2 \right) + P_3 = P_1 + \left( P_2 + P_3 \right)$ \hfill \textit{(ассоциативность)}
			\end{enumerate}
		\end{tcolorbox}
		
		\begin{itemize}
			\item $-P = (x,-y)$ для кривой в краткой форме
		\end{itemize}
		
		\structure{Вывод:} \\$
		E(K)$ -- аддитивная абелева группа
		\\
		$E(\mathbb{Q})$ -- конечно-порожденная группа
		\\
		$E(\mathbb{F}_q)$ -- конечная группа \structure{$\Rightarrow$} криптография на DLOG
	\end{frame}
	
	\begin{frame}{Быстрое умножение точки на число}
		\begin{columns}
			\begin{column}{0.5\textwidth}
				\[
				P \to \left[ k \right] \cdot P = \underbrace {P + P +  \ldots  + P}_{k{\text{-раз}}}
				\]
			\end{column}
			\begin{column}{0.5\textwidth}
				\begin{center}
					\begin{tcolorbox}[enhanced,hbox,colback=box-blue-color!15,colframe=box-blue-color,title=Сложность,center title]
						\begin{varwidth}{\textwidth}
							\begin{center}
								$k-1$ сложений (наивно)
							\end{center}
						\end{varwidth}
					\end{tcolorbox}	
				\end{center}
			\end{column}
		\end{columns}
		%
		\begin{columns}
			\begin{column}{0.5\textwidth}
				\structure{Бинарный метод:}\\
				$k = \sum\limits_{j = 0}^{\ell - 1} {{k_j}{2^j}} ,\quad {k_j} \in \left\{ {0,1} \right\}$\\
				\begin{enumerate}
					\item $Q \leftarrow \mathcal{O}$
					\item \structure{for} $j = \ell - 1$ \structure{to} $0$ \structure{by} $-1$:\\
					\quad$Q \leftarrow \left[ 2 \right]Q$ \\
					\quad \structure{if} ${k_j} = 1$:\\
					\quad\quad$Q \leftarrow Q + P$
					\item \structure{return} $Q$
				\end{enumerate}
			\end{column}
			\begin{column}{0.5\textwidth}
				\begin{center}
					\begin{tcolorbox}[enhanced,hbox,colback=box-blue-color!15,colframe=box-blue-color,title=Сложность,center title]
						\begin{varwidth}{\textwidth}
							%\begin{enumerate}
							%\item
							удвоений: $O(\lg k)$ \\
							%\item
							сложений: $\omega t(k)\sim O (\lg k)$\\
							($\omega t$ -- вес Хэмминга $k$)\\
							%\end{enumerate}
							\structure{всего}: $O\left( {\lg k} \right)$
							%\begin{center}
							%\item $O(\lg k)$ удвоений\\
							%$\omega t(k)\sim O (\lg k)$ сложений\\
							%($\omega t$~--~вес Хэмминга $k$)
							%всего:$ \Rightarrow O \left( {\lg k} \right)$ операций сложения (дублирования).
							%\end{center}
						\end{varwidth}
					\end{tcolorbox}	
				\end{center}
			\end{column}
		\end{columns}
		%\structure{Быстрое возведение в степень (бинарный метод):}
	\end{frame}
	
	\begin{frame}{Протокол Диффи -- Хеллмана}{Выработка общего секретного ключа}
		%    \begin{columns}
			%        \begin{column}{0.4\textwidth}
				%            \begin{flushright}
					%               \structure{{\Large\faUserSecret}}    
					%            \end{flushright} 
				%        \end{column}
			%        \begin{column}{0.2\textwidth}
				%            \begin{center}
					%                $\xleftrightarrow{\hspace*{0.5cm} P \in E(\mathbb{F}_q) \hspace*{0.5cm}}$
					%            \end{center}
				%        \end{column}
			%        \begin{column}{0.4\textwidth}
				%            \begin{flushleft}
					%                 \structure{{\Large\faCat}}
					%            \end{flushleft}
				%        \end{column}
			%    \end{columns}
		%    
		%    \begin{center}
			%        %\structure{{\Large\faUserSecret} $\longrightarrow$ {\Large\faCat}}
			%        %$\stackrel{P \in E(\mathbb{F}_q)}{\xleftrightarrow{\hspace*{3cm}}}$
			%        \structure{{\Large\faUserSecret}} $\xleftrightarrow{\hspace*{1cm} P \in E(\mathbb{F}_q) \hspace*{1cm}}$ \structure{{\Large\faCat}}
			%        \\
			%        \structure{$a \in \mathbb{N}$} $\xrightarrow{\hspace*{1cm} [a] P \hspace*{1cm}}$
			%        $\hspace*{1em}$
			%        \\
			%        $\hspace*{1em}$ $\xleftarrow{\hspace*{1cm} [b] P \hspace*{1cm}}$
			%          \structure{$b \in \mathbb{N}$}
			%         \\
			%    \end{center}
		%    %\begin{enumerate}
		%    %    \item
		%        %\structure{{\Large\faUserSecret} $\longrightarrow$ {\Large\faCat}}
		%    %\end{enumerate}
		%
		\begin{center}
			\begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
				%Straight Lines [id:da0832972187828418] 
				\draw    (80,35) -- (185,35) ;
				\draw [shift={(188,35)}, rotate = 540] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (5.36,-2.57) -- (0,0) -- (5.36,2.57) -- cycle    ;
				\draw [shift={(77,35)}, rotate = 360] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (5.36,-2.57) -- (0,0) -- (5.36,2.57) -- cycle    ;
				%Straight Lines [id:da17602726868869878] 
				\draw    (80,70) -- (185,70) ;
				\draw [shift={(188,70)}, rotate = 540] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (5.36,-2.57) -- (0,0) -- (5.36,2.57) -- cycle    ;
				%Straight Lines [id:da5151276494097119] 
				\draw    (80,105) -- (185,105) ;
				\draw [shift={(79,105)}, rotate = 360] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (5.36,-2.57) -- (0,0) -- (5.36,2.57) -- cycle    ;
				
				% Text Node
				\draw (50,24) node [anchor=north west][inner sep=0.75pt]   [align=left] { \structure{{\Large\faUserSecret}} };
				\draw (200,24) node [anchor=north west][inner sep=0.75pt]   [align=right] {\structure{{\Large\faCat}}};
				\draw (102,15) node [anchor=north west][inner sep=0.75pt]   [align=center] {$P \in E(\mathbb{F}_q)$};
				% Text Node
				\draw (35,62) node [anchor=north west][inner sep=0.75pt]   [align=left] { \structure{$a \in \mathbb{N}$} };
				\draw (120,50) node [anchor=north west][inner sep=0.75pt]   [align=left] {$[a] P$};
				% Text Node
				\draw (120,86) node [anchor=north west][inner sep=0.75pt]   [align=left] {$[b]P$};
				\draw (190,98) node [anchor=north west][inner sep=0.75pt]   [align=right] { \structure{$b \in \mathbb{N}$} };
				% Text Node
				\draw (-40,130) node [anchor=north west][inner sep=0.75pt]   [align=left] {\structure{\boxed{[ab]P = [a]([b]P)}}};
				\draw (190,130) node [anchor=north west][inner sep=0.75pt]   [align=left] {\structure{\boxed{[ab]P = [b]([a]P)}}};
			\end{tikzpicture}
		\end{center}
		\begin{itemize}
			\item Безопасность основана на сложности нахождения \structure{DLOG} (как минимум): \[(P, [n]P) \mapsto n\]
		\end{itemize}
	\end{frame}
	
	\begin{frame}{Атака ``человек посередине''\footnote{\textit{(англ.)} man in the middle (MITM)}}
		\begin{center}


\tikzset{every picture/.style={line width=0.75pt}} %set default line width to 0.75pt        

\begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
	%%%%%%%%%%%%%%%%%%%
	% Left side arrows
	%%%%%%%%%%%%%%%%%%%
	%Straight Lines [id:da17602726868869878] 
	\draw (145,130) -- (205,130);
	\draw [shift={(207,130)}, rotate = 180] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (5.36,-2.57) -- (0,0) -- (5.36,2.57) -- cycle;
	
	%Straight Lines [id:da606368011362501]
	\draw    (145,165) -- (205,165) ;
	\draw [shift={(142,165)}, rotate = 360] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (5.36,-2.57) -- (0,0) -- (5.36,2.57) -- cycle;
	
	%Straight Lines [id:da0586486120331462] 
	\draw    (145,195) -- (205,195) ;
	\draw [shift={(207,195)}, rotate = 180] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (5.36,-2.57) -- (0,0) -- (5.36,2.57) -- cycle;

	%%%%%%%%%%%%%%%%%%%%
	% Right side arrows
	%%%%%%%%%%%%%%%%%%%%
	%Straight Lines [id:da5151276494097119] 
	\draw (320,130) -- (380,130) ;
	\draw [shift={(318,130)}, rotate = 360] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (5.36,-2.57) -- (0,0) -- (5.36,2.57) -- cycle;

	%Straight Lines [id:da09168079881977365] 
	\draw    (320,165) -- (380,165) ;
	\draw [shift={(382,165)}, rotate = 180] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (5.36,-2.57) -- (0,0) -- (5.36,2.57) -- cycle;

	%Straight Lines [id:da4782643167070846] 
	\draw    (320,195) -- (380,195) ;
	\draw [shift={(382,195)}, rotate = 180] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (5.36,-2.57) -- (0,0) -- (5.36,2.57) -- cycle;
	
	%%%%%%%%%%%%%%%%%%%%%%%
	% Text nodes for Agent
	%%%%%%%%%%%%%%%%%%%%%%%
	% Text Node
	\draw (120,72) node [anchor=north west][inner sep=0.75pt]   [align=left] {\structure{{\Large\faUserSecret}}};

	% Text Node
	\draw (100,122) node [anchor=north west][inner sep=0.75pt]   [align=left] {\structure{$a \in \mathbb{N}$}};

	% Text Node
	\draw (52,156) node [anchor=north west][inner sep=0.75pt]   [align=left] {\structure{$k_a = [a] ([c] P)$}};
	
	% Text Node
	\draw (42,186) node [anchor=north west][inner sep=0.75pt]   [align=left] {\structure{$c_a=Enc_{k_a}(\text{\faCheese})$}};
	
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	% Text nodes for left side arrows
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	% Text Node
	\draw (162,110) node [anchor=north west][inner sep=0.75pt]   [align=left] {$[a] P$};

	% Text Node
	\draw (162,146) node [anchor=north west][inner sep=0.75pt]   [align=left] {$[c] P$};

	% Text Node
	\draw (170,180) node [anchor=north west][inner sep=0.75pt]   [align=left] {$c_a$};

	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	% Text nodes for public parameters
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	% Text Node
	\draw (225,35) node [anchor=north west][inner sep=0.75pt]   [align=left] {\structure{\boxed{P \in E(\mathbb{F}_q)}}};

	%%%%%%%%%%%%%%%%%%%%%%%
	% Text nodes for Mouse
	%%%%%%%%%%%%%%%%%%%%%%%
	% Text Node
	\draw (245,115) node [anchor=north west][inner sep=0.75pt]   [align=center] {\includegraphics[width=2.5em]{mouse.png}};

	% Text Node
	\draw (245,155) node [anchor=north west][inner sep=0.75pt]   [align=center] {\structure{$c \in \mathbb{N}$}};

	% Text Node
	\draw (215,186) node [anchor=north west][inner sep=0.75pt]   [align=center] {\structure{$\text{\faCheese} = Dec_{k_a}(c_a)$}};

	% Text Node
	\draw (216,215) node [anchor=north west][inner sep=0.75pt]   [align=left] {\structure{$c_b = Enc_{k_b}(\text{\faCheese})$}};


	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	% Text Nodes for right side arrows
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	% Text Node
	\draw (335,110) node [anchor=north west][inner sep=0.75pt]   [align=left] {$[b] P$};	
	
	% Text Node
	\draw (335,146) node [anchor=north west][inner sep=0.75pt]   [align=left] {$[c] P$};
	
	% Text Node
	\draw (340,180) node [anchor=north west][inner sep=0.75pt]   [align=left] {$c_b$};


	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	% Text Nodes for Cat
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	% Text Node
	\draw (385,72) node [anchor=north west][inner sep=0.75pt]   [align=left] {\structure{{\Large\faCat}}};

	% Text Node
	\draw (385,122) node [anchor=north west][inner sep=0.75pt]   [align=left] {\structure{$b \in \mathbb{N}$}};

	% Text Node
	\draw (385,156) node [anchor=north west][inner sep=0.75pt]   [align=left] {\structure{$k_b = [b] ([c] P)$}};
	
	% Text Node
	\draw (385,186) node [anchor=north west][inner sep=0.75pt]   [align=left] {\structure{$\text{\faCheese} = Dec_{k_b}(c_b)$}};
	
\end{tikzpicture}
		\end{center}

%		\begin{itemize}
%			\item \structure{{\Large\faCheese}} \includegraphics[width=2.5em]{mouse.png}
%		\end{itemize}
	\end{frame}

%	\begin{frame}{Цифровая подпись}
%	\end{frame}
	
%	\begin{frame}{Стандарты}
%		\begin{enumerate}
%			\item EC
%		\end{enumerate}
%	\end{frame}
	
%	\begin{frame}{Пример использования обмена ключами или подписи}
%		\begin{enumerate}
%			\item TODO: скриншот сертификата, параметры
%		\end{enumerate}
%	\end{frame}
	
	\begin{frame}{Оптимизация: проективные координаты}
		\[E: Y^2 Z = X^3+ A x Z^2 + B Z^3\]
		\begin{gather*}
			P_3 = P_1 + P_2 \\
			u = Y_2 Z_1 - Y_1 Z_2\\
			v = X_2 Z_1 - X_1 Z_2 \\
			X_3 = v(\underbrace{u^2 Z_1 Z_2 - v^3 - 2 v^2 X_1 Z_2}_w), \\
			Y_3 = u(X_1 v^2 Z_2 - w) - v^3 Z_2 Y_1 \\
			Z_3 = v^3 Z_1 Z_2
		\end{gather*}
		\begin{center}
			\begin{tcolorbox}[enhanced,hbox,colback=box-blue-color!15,colframe=box-blue-color,title=Сложность,center title]
				\begin{varwidth}{\textwidth}
					$12$M (проективные) \structure{vs} I + $3$M (аффинные)
				\end{varwidth}
			\end{tcolorbox}	
		\end{center}
	\end{frame}
	
	\begin{frame}{Оптимизация: особые формы кривой}
		\structure{Кривые Монтгомери:}
		\[
		B y^2 = x^3 + A x^2 + x
		\]
		\begin{center}
			\begin{tcolorbox}[enhanced,hbox,colback=box-blue-color!15,colframe=box-blue-color,title=Сложность,center title]
				\begin{varwidth}{\textwidth}
					удвоение+сложение: $6$M + $4$S
				\end{varwidth}
			\end{tcolorbox}	
		\end{center}
		\structure{Curve25519}: $B = 1, A = 486662, q=p=2^{255} - 19$.
		
		\structure{Также:} кривые Эдвардса, в форме Якоби и др.
	\end{frame}
	
	%\begin{frame}{Групповой закон}{Альтернативные координаты}
	%    content...
	%\end{frame}
	
	\begin{frame}{Литература}
		%\begin{itemize}
		%    \item TODO: литература по эффективной арифметике ЭК
		%    \item Ссылки на стандартизированные кривые исп. проективные координаты
		%\end{itemize}
		\nocite{Menezes1993}\nocite{Blake1999}\nocite{Washington2008}
		\printbibliography
		
		\begin{center}
			\begin{tcolorbox}[enhanced,hbox,colback=block-green-color-bg,colframe=subsection-color!120,title=Контакты,center title]
				\begin{varwidth}{\textwidth}
					\begin{center}
						\href{mailto:snovoselov@kantiana.ru}{snovoselov@kantiana.ru}
					\end{center}
				\end{varwidth}
			\end{tcolorbox}	
		\end{center}
		
		\structure{Страница курса:}\\
		{\footnotesize
			\href{https://crypto-kantiana.com/semyon.novoselov/teaching/elliptic_curves_2022}{crypto-kantiana.com/semyon.novoselov/teaching/elliptic\_curves\_2022}
		}
		
	\end{frame}
	
\end{document}